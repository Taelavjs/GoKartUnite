@model GoKartUnite.ViewModel.KarterIndex

<div class="container mb-5">
	<!-- Profile Section -->
	<div class="profile-section">
		<div class="profile-header">
			<div class="profile-image"></div>
			<div class="profile-details">
				<div class="profile-name">
									@Model.karter.Name 
					<a asp-action="EditUserDetails" class="btn btn-sm btn-success p-0" style="border: none; background-color: transparent;">
						<i class="bi bi-pencil-fill" style="color: green;"></i>
					</a>
				</div>				
				<div class="profile-info">
					<div><label>Local Track:</label> @(Model.karter.Track == null ? "None" : Model.karter.Track.Title)</div>
					<div><label>Email:</label> @Model.karter.Email</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Table Section -->
	<div class="table-section">
		<!-- Friends Table -->
		<div class="table-container">
			<table>
				<thead>
					<tr>
						<th></th>
						<th></th>
						<th>Friends</th>
						<th></th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					@foreach (var friend in Model.karterFriends)
					{
						@await Html.PartialAsync("karter", friend)
					}
				</tbody>
			</table>
		</div>

		<div class="table-container">
			<table>
				<thead>
					<tr>
						<th></th>
						<th></th>
						<th>Incoming Requests</th>
						<th></th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					@foreach (var friend in Model.karterFriendRequests)
					{
						@await Html.PartialAsync("karter", friend)
					}
				</tbody>
			</table>
		</div>
	</div>

	<div class="table-container ">
		<table>
			<thead>
				<tr>
					<th></th>
					<th></th>
					<th>Outgoing Requests</th>
					<th></th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				@foreach (var friend in Model.sentFriendRequests)
				{
					@await Html.PartialAsync("karter", friend)
				}
			</tbody>
		</table>
	</div>

	<div class="col-md-6 w-100">
		<select id="GraphTitleSelector" 
				class="form-select form-select-sm fs-4 align-center text-center">
			@foreach (var status in Model.trackTitles)
			{
					<option value="@status" class="text-center fs-5">@status</option>
			}
		</select>
	</div>

	<div class="w-100">
		<canvas class="w-100" id="myLineChart"></canvas>
	</div>

	<!-- Collapsible Partial View Container (Slides In/Out) -->
	<div id="statFormContainer" class="collapse mt-3">
		<div class="card card-body shadow-sm">
			@await Html.PartialAsync("_CreateKarterStatTrack", new GoKartUnite.ViewModel.KarterStatCreatePage
			{
				trackTitle = Model.trackTitles
			})
		</div>
	</div>

	<!-- Button to Toggle Partial View (Always Visible) -->
	<div class="d-flex justify-content-start mt-3">
		<button id="toggleStatForm" class="btn btn-success" type="button" data-bs-toggle="collapse" data-bs-target="#statFormContainer">
			Add
		</button>
	</div>



</div>

@section Scripts
{
		<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script> <!-- Chart.js Date Adapter -->
		<script src="~/js/KarterStat.js" asp-append-version="true"></script>

}
